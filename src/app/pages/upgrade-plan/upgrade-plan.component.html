<ngx-spinner class="cusSpinner">
  <div class="loader-wrapper">
    <div class="truck-wrapper">
      <div class="truck">
        <div class="truck-container"></div>
        <div class="glases"></div>
        <div class="bonet"></div>
        <div class="base"></div>
        <div class="base-aux"></div>
        <div class="wheel-back"></div>
        <div class="wheel-front"></div>
        <div class="smoke"></div>
      </div>
    </div>
  </div>
</ngx-spinner>
<section class="cus-round-with-bg">
  <div class="container ">
    <h2 class="text-uppercase text-center mb-2">
      {{ 'subscription_plan.upgrade_plan' | translate }} {{heading}} {{
      'subscription_plan.plan' | translate }}</h2>
    <mat-horizontal-stepper #stepper id="planUpgrade" [linear]="isLinear">
      <mat-step [stepControl]="formGroup1">

        <form [formGroup]="firstFormGroup" class="row cusPlanPage">
          <div class="row">
            <div class="col-sm-6">
              <ng-template matStepLabel style="display: none !important;">Select Plan</ng-template>
            </div>
          </div>
          <div class="col-sm-12 text-center mb-4 pt-1 pb-4">
            <div class="cus-select-plan-opt">
              <button type="button" class="btn text-uppercase" [ngClass]="singleClass ? 'active' : 'noActive'"
                (click)="planMonthOption('MONTHLY')">monthly</button>
              <button type="button" class="btn text-uppercase" [ngClass]="singleClassYearly ? 'inActive' : 'noActive'"
                (click)="planMonthOption('YEARLY')">Yearly</button>
            </div>
          </div>
          <div class="col-sm-12 d-flex align-items-center justify-content-center" *ngIf="planList.length">
            <div class="cus-plan-wrap col-sm-4" *ngFor="let list of planList ;let i = index"
              [ngClass]="list.plan_name == 'BASIC' ? 'cus-basic' : 'cus-premium'">
              <div class="set-width text-center">
                <h4 class="text-center cus-recom" *ngIf="list.plan_name == 'PREMIUM' ">RECOMMENDED</h4>
                <h3 class="text-center">{{ list.plan_name | titlecase }}</h3>
                <div class="text-center cus-pric-plan">
                  <div class="cus-discount-price d-flex align-items-center justify-content-center"
                    *ngIf="list.planPrice >1">
                    <span class="cus-syb">$</span>
                    <span class="cus-currency"> {{list.planPrice}}</span>
                  </div>
                  <div class="cus-final-price d-flex align-items-center justify-content-center">
                    <span class="cus-syb">$</span>
                    <span class="cus-currency"> {{list.finalPrice}}</span>
                  </div>
                </div>
                <div class="cus-plan-option text-center mb-5">
                  <ul>
                    <li *ngFor="let feature of list.features; ">
                      <span class="float-left">
                        <img src="assets/checked.png" />
                        {{ feature.keyName | titlecase }}
                      </span>
                      <span class="float-right">
                        {{ feature.keyValue }}
                      </span>
                    </li>

                  </ul>
                </div>
                <div class="pri-plan-grp text-center">

                  <a class="pricing-button btn text-uppercase" (click)='payment(list._id)'>{{ 'buttons.buy_now' |
                    translate }}</a>
                </div>
              </div>
            </div>
          </div>
          <div class="cus-plan-wrap text-center col-sm-4 m-auto" *ngIf="planList.length==0">
            Plan not available
          </div>
        </form>
      </mat-step>
      <mat-step [stepControl]="secondGroup1">
        <form [formGroup]="secondFormGroup" class="row cusPlanPage">
          <div class="row">
            <div class="col-sm-6">
              <ng-template matStepLabel>Select Plan</ng-template>
            </div>
          </div>
          <div class="col-sm-12 d-flex align-items-center justify-content-center">
            <div class="row">
              <div class="col-sm-12 cus-pay-wrapper ">
                <section class="cus_payment_sec">

                </section>
                <div class="payment">
                  <div class="price_head">
                    <div class="col-sm-6 text-center">
                      <p class="price">Price</p>
                    </div>
                    <div class="col-sm-6 text-center">
                      <p class="price">${{finalPrice}}</p>
                    </div>
                  </div>

                  <form novalidate [formGroup]="stripeTest">
                    <div class="col-sm-12 text-center">

                      <div class="row">
                        <div class="col-sm-12">
                          <h3 class="col-sm-12 d-flex card_detail m-b-2">Card Details</h3>
                          <div class="col-sm-12 mb-3 p-l-0 p-r-0 d-flex justify-content-between cardimg">
                            <img oncontextmenu="return false;" src="/assets/card-1.png" width="60">
                            <img oncontextmenu="return false;" src="/assets/card-2.png" width="60">
                            <!-- <img
                              oncontextmenu="return false;" src="/assets/card-3.png" width="80">  -->
                            <img oncontextmenu="return false;" src="/assets/card-4.png" width="60">
                          </div>
                        </div>
                        <div class="col-sm-6">
                          <mat-form-field appearance="outline">
                            <mat-label>Cardholder name</mat-label> <input type="text" autocomplete="off"
                              formControlName="name" matInput />
                            <mat-error *ngIf="stripeTest.get('name').hasError('required')"> Please enter name
                            </mat-error>
                          </mat-form-field>
                        </div>
                        <div class="col-sm-6">
                          <mat-form-field appearance="outline">
                            <mat-label>Billing address</mat-label> <input type="text" autocomplete="off"
                              formControlName="billingAddress" matInput />
                            <mat-error *ngIf="stripeTest.get('billingAddress').hasError('required')"> Please
                              enter billing address</mat-error>
                          </mat-form-field>
                        </div>
                        <div class="col-sm-12">
                          <mat-form-field appearance="outline" class="cus-pin-with-no">
                            <mat-label>Phone number</mat-label> <span class="cus-pin-code">+1</span> <input type="text"
                              mask="(000) 000-0000" autocomplete="off" formControlName="phoneNumber" matInput />
                            <mat-error *ngIf="stripeTest.get('phoneNumber').hasError('required')"> Please enter
                              phone number</mat-error>
                            <mat-error *ngIf="stripeTest.get('phoneNumber').hasError('minlength')"> Please enter
                              valid number</mat-error>
                          </mat-form-field>
                        </div>
                        <div class="col-sm-12">
                          <div class="card-border cus-stripe-card  mb-3">
                            <ngx-stripe-card [options]="cardOptions" [elementsOptions]="elementsOptions"> </ngx-stripe-card>
                          </div>
                        </div>
                        <div class="col-sm-12 text-center">
                          <button (click)="prevoousSteper()" class="btn btn-continue btn-primary text-center mt-4"
                            type="submit" [disabled]='!finalPrice'>Back</button>
                          &nbsp;<button (click)="createToken()" class="btn btn-continue btn-primary text-center mt-4"
                            type="submit" [disabled]='!finalPrice'>Continue</button>
                        </div>
                      </div>
                    </div>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </form>
      </mat-step>
    </mat-horizontal-stepper>
  </div>
</section>