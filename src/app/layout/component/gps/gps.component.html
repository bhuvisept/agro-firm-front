<ngx-spinner class="cusSpinner">
  <div class="loader-wrapper">
    <div class="truck-wrapper">
      <div class="truck">
        <div class="truck-container"></div>
        <div class="glases"></div>
        <div class="bonet"></div>
        <div class="base"></div>
        <div class="base-aux"></div>
        <div class="wheel-back"></div>
        <div class="wheel-front"></div>
        <div class="smoke"></div>
      </div>
    </div>
  </div>
</ngx-spinner>
<div class="main">
  <div id="map"></div>
</div>
<div class="cus_toggel_gps" (click)="toggleBtn()" [ngClass]="openNav ? 'd-block' : 'd-none'">
  <i class="fa fa-bars" style="font-size: 30px"></i>
</div>
<div [ngClass]="!openNav ? 'weather_slide' : 'mainTop '">
  <div *ngIf="!planActive">
    <a class="ml-1 main_div" (click)="createTripPlan()">{{ 'gps_form.show_weather' | translate }}</a>
  </div>
  <div class="" *ngIf="planActive">
    <div class="cusWeatherDay" [class.active]="isActive">
      <div>
        <i (click)="isActive = !isActive" class="fa fa-calendar"></i>
        <ul ngDefaultControl [(ngModel)]="selectedLevel">
          <li *ngFor="let item of data; let i = index" [value]="item.name" [ngClass]="this.spareValueIdx == i ? 'active' : ''" (click)="selected($event, i)">
            {{ item.name + ' ' }}
          </li>
        </ul>
      </div>
    </div>
    <div class="selection">
      <div class="mt-3">
        <div>
          <img class="cus_crle" src="/assets/allWeather.png" />
          <span>
            <a class="ml-1 main_div" (click)="allOption()">{{ 'gps_form.All' | translate }}</a>
          </span>
        </div>
      </div>
      <div *ngIf="this.layerBanner == true" class="mt-3">
        <div>
          <img class="cus_crle" src="/assets/snow.png" />
          <span
            ><a class="ml-1 main_div" (click)="snowWeatherDay1()" (click)="layerRemove()">{{ 'gps_form.Snow' | translate }}</a></span
          >
        </div>
      </div>
      <div *ngIf="this.layerBanner == false" class="mt-3">
        <div>
          <img class="cus_crle" src="/assets/precipitation.png" />
          <span
            ><a class="ml-1 main_div" (click)="PrepWeatherDay1()" (click)="layerRemove()">{{ 'gps_form.Precipitation' | translate }}</a></span
          >
        </div>
      </div>
      <div *ngIf="this.layerBanner == true" class="mt-3">
        <div>
          <img class="cus_crle" src="/assets/freeze.png" /><span
            ><a class="ml-1 main_div" (click)="freezeWeatherDay1()" (click)="layerRemove()">{{ 'gps_form.Freezing_Rain' | translate }}</a></span
          >
        </div>
      </div>
      <div *ngIf="this.layerBanner == true" class="mt-3">
        <div>
          <img class="cus_crle" src="/assets/thunderstorm.png" />
          <span
            ><a class="ml-1 main_div" (click)="thunderWeatherDay1()" (click)="layerRemove()">{{ 'gps_form.Thunderstorm' | translate }}</a></span
          >
        </div>
      </div>
      <div *ngIf="this.layerBanner == false" class="mt-3">
        <div>
          <img class="cus_crle" src="/assets/temp.png" />
          <span
            ><a class="ml-1 main_div" (click)="tempWeatherDay37()" (click)="layerRemove()">{{ 'gps_form.Temperature' | translate }}</a></span
          >
        </div>
      </div>
    </div>
  </div>
</div>

<div *ngIf="planActive == true" class="mainBottom">
  <h4 class="ml-1 mt-1" style="color: #fdffff">Legends</h4>
  <div class="cus_srll">
    <div class="d-flex align-items-center">
      <div class="cus_square" style="background-color: #00c5f1"></div>
      <span class="mt-1 cus_textcolor">Slight Snow</span>
    </div>
    <div class="d-flex align-items-center">
      <div class="cus_square" style="background-color: #008a00"></div>
      <span class="mt-1 cus_textcolor">Moderate Snow</span>
    </div>
    <div class="d-flex align-items-center">
      <div class="cus_square" style="background-color: #ff0000"></div>
      <span class="mt-1 cus_textcolor">High Snow</span>
    </div>
    <div class="d-flex align-items-center">
      <div class="cus_square" style="background-color: #1c4fad"></div>
      <span class="mt-1 cus_textcolor">Thunderstorm</span>
    </div>
    <div class="d-flex align-items-center">
      <div class="cus_square" style="background-color: #ffcd42"></div>
      <span class="mt-1 cus_textcolor">Freezing Rain</span>
    </div>
    <div class="d-flex align-items-center">
      <div class="cus_square" style="background-color: #ff6f00"></div>
      <span class="mt-1 cus_textcolor">Temperature</span>
    </div>
    <div class="d-flex align-items-center">
      <div class="cus_square" style="background-color: #a200ff"></div>
      <span class="mt-1 cus_textcolor">Precipitation</span>
    </div>
  </div>
</div>

<div class="sidenav-wrapper gps_com">
  <div [ngClass]="openNav ? 'd-none' : 'sidenav'" id="navDiv">
    <div class="row">
      <div class="col-sm-6">
        <button class="btn common-btn ml-2" (click)="back()">{{ 'buttons.back' | translate }}</button>
      </div>
      <div class="col-sm-6 text-right">
        <i class="fas fa-angle-left mr-4 mt-2" (click)="toggleBtn()" style="font-size: 24px"></i>
      </div>
    </div>
    <div class="form-input-data">
      <form class="example-form" [formGroup]="tripAddress">
        <div class="col-sm-12">
          <mat-form-field appearance="outline" class="mt-1">
            <mat-label>{{ 'gps_form.Origin' | translate }}</mat-label>
            <input class="m-0 p-0" matInput formControlName="source" #search matInput placeholder="Source Address" />
          </mat-form-field>

          <p class="m-b-1 m-0 text-center" style="cursor: pointer" (click)="getLocation()">Select my location</p>
          <!-- <div class="row" *ngFor="let destination of getdestinationFormControls(); let i = index">
            <div class="col-sm-10">
              <mat-form-field class="example-full-width" appearance="outline">
                <mat-label>{{ 'gps_form.Destination' | translate }} {{i}}</mat-label>
                <input matInput [formControl]="destination" #destination matInput placeholder="Destination Address" (input)="autosearchdestination(i)" />
  
              </mat-form-field>
            </div>
            <div class="col-sm-2">
              <i *ngIf="i != 0 " class="fa fa-minus" style="font-size:36px;color:#065AA4" (click)="removeDestination(i)"></i>
            </div>
          </div> -->
          <div class="row" *ngFor="let destination of getdestinationFormControls(); let i = index"
          draggable="true"
          (dragstart)="onDragStart($event, i)"
          (dragover)="onDragOver($event, i)"
          (drop)="onDrop($event, i)">
       <div class="col-sm-10">
       
         <mat-form-field class="example-full-width" appearance="outline">
           <mat-label>{{ 'gps_form.ChooseDestination' | translate }}</mat-label>
           <!-- <mat-label>{{ 'gps_form.Destination' | translate }} {{i}}</mat-label> -->
           <input matInput [formControl]="destination" #destination matInput placeholder="Destination Address" (input)="autosearchdestination(i)"/>
         </mat-form-field>
       </div>
       <div class="col-sm-1">
        <i *ngIf="i != 0" class="fa fa-ellipsis-v"style="font-size:24px;color:#065AA4;margin-top:5px" ></i>
       </div>
       <div class="col-sm-1">
         <i *ngIf="i != 0" class="fa fa-times-circle" style="font-size:24px;color:#065AA4;margin-top: 5px" (click)="removeDestination(i)"></i>
       </div>
     </div>
               <div class="col-sm-12 d-flex justify-content-end mb-3">
            <button class="common-btn btn" (click)="addDestination()"> Add Destination</button>
          </div>
          <mat-form-field class="example-full-width" appearance="outline">
            <mat-label>{{ 'gps_form.Gross_Weight' | translate }}(lbs)</mat-label>
            <input matInput formControlName="grossWeight" mask="00000" matInput placeholder="gross weight" />
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-select formControlName="routeFlag">
              <mat-option value="arriveBy">Arrive by </mat-option>
              <mat-option value="departAt">Depart at </mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>{{ 'form_lables.trip_planner.Date_Time' | translate }}</mat-label>
            <input
              (click)="pickerStartDate.open()"
              (focus)="pickerStartDate.open()"
              matInput
              readonly
              [ngxMatDatetimePicker]="pickerStartDate"
              formControlName="date_Time"
              [min]="min"
              [max]="maxDate"
              [attr.disabled]="false"
              required
            />
            <mat-datepicker-toggle matSuffix [for]="pickerStartDate"></mat-datepicker-toggle>
            <ngx-mat-datetime-picker
              #pickerStartDate
              [showSpinners]="showSpinners"
              [showSeconds]="showSeconds"
              [stepHour]="stepHour"
              [stepMinute]="stepMinute"
              [stepSecond]="stepSecond"
              [touchUi]="touchUi"
              [color]="color"
              [enableMeridian]="enableMeridian"
            >
            </ngx-mat-datetime-picker>
          </mat-form-field>
          <mat-form-field class="example-full-width" appearance="outline">
            <mat-label>{{ 'gps_form.Select_Truck' | translate }}</mat-label>
            <mat-select formControlName="truckId" (selectionChange)="getTruck()" placeholder="select truck" required>
              <mat-option *ngFor="let list of truckList" [value]="list._id">
                {{ list.name }}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field class="example-full-width" appearance="outline">
            <mat-label>{{ 'gps_form.Select_Trailer' | translate }}</mat-label>
            <mat-select formControlName="trailerId" (selectionChange)="getTrailer()" placeholder="select tariler" required>
              <mat-option *ngFor="let list of trailerList" [value]="list._id">
                {{ list.name }}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <div class="col-sm-2 mt-2 mb-3 text-center">
            <mat-checkbox class="example-margin" color="primary" (change)="setLoadType($event)">HAZMAT Load  <i class="fa fa-info-circle" style="font-size:14px" matTooltip=" Hazmat stands for 'hazardous materials' and can include a wide range of substances such as explosives, flammable gases and liquids, poisons, radioactive materials, infectious substances, and other dangerous goods." matTooltipPosition="right"></i> </mat-checkbox>
          </div>
          <!-- <div class="col-sm-12" *ngIf="hazmat"> -->
          <mat-form-field appearance="outline" *ngIf="hazmat">
            <mat-label>{{ 'gps_form.Load_Type' | translate }}</mat-label>
            <mat-select formControlName="loadType">
              <mat-option *ngFor="let list of vehicleLoadType" [value]="list.class">{{ list.type }} </mat-option>
            </mat-select>
          </mat-form-field>
        </div>

        <div class="col-md-12 text-right mt-2 mb-2">
          <button class="common-btn btn" type="submit" (click)="onsubmit()">{{ 'buttons.Direction' | translate }}</button>
        </div>
      </form>
      <div class="recent_trip mt-2 mb-5">
        <hr />
        <h5 class="text-center">Recent Trips</h5>
        <p *ngIf="!recentTotalCount" class="text-center trips mt-3">{{ 'No_Records_Found' | translate }}</p>
        <div class="row" *ngIf="recentTotalCount">
          <p class="col-sm-6 text-center bold">Source</p>
          <p class="col-sm-6 text-center bold">Destination</p>
        </div>
        <div class="row mt-1 trips" *ngFor="let trip of recentTrips" (click)="recentRoute(trip)">
          <div class="source text-center col-sm-6">
            <p>{{ trip.source.address }}</p>
          </div>
          <div class="destination col-sm-6 text-center">
            <p>{{ trip.destination.address }}</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
