<ngx-spinner class="cusSpinner">
    <div class="loader-wrapper">
        <div class="truck-wrapper">
        <div class="truck">
            <div class="truck-container"></div>
            <div class="glases"></div>
            <div class="bonet"></div>
            <div class="base"></div>
            <div class="base-aux"></div>
            <div class="wheel-back"></div>
            <div class="wheel-front"></div>
            <div class="smoke"></div>
        </div>
        </div>
    </div>
</ngx-spinner>
<div class="custom_form">
    <a [routerLink]="['/home-page']"><img src="assets/truck-logo.png" alt="" class="w-100"></a>
</div>
<div class="main_section m-auto">
    <div class="container">
        <section class="cus-round-with-bg">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-sm-12 cus-dashbord cus-ds-main-bg">
                        <form [formGroup]="updateCompanyProfileForm">
                            <div class="modal-body p-0">
                                <div class="row cus-upload">
                                    <div class="col-sm-12 cus-cover-img p-l-0 p-r-0">

                                        <div class="banner-upload">
                                            <div *ngIf="!uploadedBannerImage && !isLoadingBanner">
                                                <img *ngIf="!bannerImage" src="assets/Truck-banne-bg.png" width="100%"
                                                    height="300px" />
                                                <img *ngIf="bannerImage" src="{{ banner_img_path }}{{ bannerImage }}"
                                                    width="100%" height="300px" />
                                            </div>
                                            <div class="col-12 d-flex justify-content-center align-items-center my-5" >
                                                <mat-progress-bar  *ngIf="isLoadingBanner " class="example-margin" [color]="'primary'" [mode]="'indeterminate'"  #spinner>
                                                </mat-progress-bar>
                                               </div>
                                            <div *ngIf="uploadedBannerImage && !isLoadingBanner">
                                                <img src="{{banner_img_path}}{{uploadedBannerImage}}" width="100%"
                                                    height="300px" />
                                            </div>
                                        </div>
                                        <div class="float-right cus-edit-cover-icon" *ngIf="!isLoadingBanner">
                                            <input required type="file" class="fa fa-pencil" (click)="InputFile.value = null" #InputFile
                                                accept="image/png, image/jpeg" (change)="fileChangeEvent($event)" />
                                            <span><i class="fa fa-pencil" aria-hidden="true"></i></span>
                                            <div id='open-diaLog' data-toggle="modal"
                                                data-target="#banner-image-dialog"></div>
                                        </div>
                                    </div>
                                    <div class="col-sm-12">
                                        <div class="cus-profile-img">
                                            <div *ngIf="!this.uploadedCompanyLogo && !isLoadingLogo">
                                                <img *ngIf="!profileLogo" src="assets/Truck-banne-profile.png"
                                                    class="img-fluid" />
                                                <img *ngIf="profileLogo" src="{{ companyLogo_path + profileLogo }}"
                                                    class="img-fluid" />
                                            </div>
                                            <div class="d-flex justify-content-center align-items-center" *ngIf="isLoadingLogo">
                                                <mat-spinner [diameter]="35"></mat-spinner>
                                               </div>
                                            <div *ngIf="this.uploadedCompanyLogo && !isLoadingLogo">
                                                <img src="{{ image_enduser_profile }}{{ this.uploadedCompanyLogo }}"
                                                    class="img-fluid" />
                                            </div>
                                            <div>
                                                <img [src]="croppedLogo" class="img-fluid" />
                                            </div>
                                        </div>
                                        <div class="cus-edit-profile-icon cus-upload-icon-outise" *ngIf="!isLoadingLogo">
                                            <input required type="file" class="fa fa-pencil" (click)="myInputFile.value = null" #myInputFile 
                                                accept="image/png, image/jpeg" (change)="logoChangeEvent($event)" />
                                            <span><i class="fa fa-pencil" aria-hidden="true"></i></span>
                                            <div id='open-diaLog-logo' data-toggle="modal"
                                                data-target="#logo-image-dialog"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Company Name </mat-label>
                                            <input type="text" formControlName="companyName" matInput
                                                placeholder="Company Name" required maxlength="30" />
                                            <mat-error
                                                *ngIf="updateCompanyProfileForm.get('companyName').hasError('required')">
                                                Please enter company name </mat-error>
                                            <mat-error
                                                *ngIf="updateCompanyProfileForm.get('companyName').hasError('pattern')">
                                                Please enter valid company name </mat-error>
                                        </mat-form-field>
                                    </div>
                                    <div class="col-sm-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Incorporation Date</mat-label>
                                            <input matInput readonly [matDatepicker]="picker" [max]="minDateOfBirth"
                                                placeholder="Incorporation Date" formControlName="incorporationDate"
                                                required />
                                            <mat-datepicker-toggle matSuffix [for]="picker"> </mat-datepicker-toggle>
                                            <mat-error
                                                *ngIf="updateCompanyProfileForm.get('incorporationDate').hasError('required')">
                                                Please enter incorporation date </mat-error>
                                            <mat-datepicker #picker></mat-datepicker>
                                        </mat-form-field>
                                    </div>
                                    <!-- <div class="col-sm-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Director Name </mat-label>
                                            <input type="text" formControlName="directorName" type="text" matInput
                                                placeholder="Director Name" required maxlength="30" />
                                            <mat-error
                                                *ngIf="updateCompanyProfileForm.get('directorName').hasError('required')">
                                                Please enter director name </mat-error>
                                            <mat-error
                                                *ngIf="updateCompanyProfileForm.get('directorName').hasError('pattern')">
                                                Please enter valid director name </mat-error>
                                        </mat-form-field>
                                    </div> -->
                                    <div class="col-sm-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>First Name </mat-label>
                                            <input type="text" formControlName="firstName" type="text" matInput
                                                placeholder="Contact Person" required maxlength="30" />
                                            <mat-error
                                                *ngIf="updateCompanyProfileForm.get('firstName').hasError('required')">
                                                Please enter first name </mat-error>
                                            <mat-error
                                                *ngIf="updateCompanyProfileForm.get('firstName').hasError('pattern')">
                                                Please enter valid first name </mat-error>
                                        </mat-form-field>
                                    </div>
                                  
                                    <div class="col-sm-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                          <mat-label>Middle Name</mat-label>
                                          <input type="text" formControlName="middleName" type="text" matInput placeholder="Middle Name"  maxlength="30" />
                                        </mat-form-field>
                                      </div>

                                    <div class="col-sm-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Last Name </mat-label>
                                            <input type="text" formControlName="lastName" type="text" matInput
                                                placeholder="Contact Person" required maxlength="30" />
                                            <mat-error
                                                *ngIf="updateCompanyProfileForm.get('lastName').hasError('required')">
                                                Please enter last name </mat-error>
                                            <mat-error
                                                *ngIf="updateCompanyProfileForm.get('lastName').hasError('pattern')">
                                                Please enter valid last name </mat-error>
                                        </mat-form-field>
                                    </div>
                                    <div class="col-sm-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Email </mat-label>
                                            <input readonly type="text" formControlName="email" matInput
                                                placeholder="Email Address" required />
                                            <mat-error
                                                *ngIf="updateCompanyProfileForm.get('email').hasError('required')">
                                                Please enter email address </mat-error>
                                            <mat-error
                                                *ngIf="updateCompanyProfileForm.get('email').hasError('pattern')">
                                                Please enter correct email </mat-error>
                                        </mat-form-field>
                                    </div>
                                    <div class="col-sm-6">
                                        <mat-form-field class="example-full-width cus-pin-with-no" appearance="outline">
                                            <mat-label>Phone Number</mat-label>
                                            <span class="cus-pin-code">+1</span>
                                            <input type="text" formControlName="mobileNumber" matInput
                                                placeholder="Phone Number" mask="(000) 000-0000" required />
                                            <mat-error
                                                *ngIf="updateCompanyProfileForm.get('mobileNumber').hasError('required')">
                                                Please enter phone number </mat-error>
                                        </mat-form-field>
                                    </div>

                                    <div class="col-sm-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label class="cus-log-lab">Address</mat-label>
                                            <input matInput formControlName="address" #Search required />
                                            <mat-error
                                                *ngIf="updateCompanyProfileForm.get('address').hasError('required')">
                                                Please enter address </mat-error>
                                            <mat-error
                                                *ngIf="updateCompanyProfileForm.get('address').hasError('pattern')">
                                                Please enter valid address </mat-error>
                                        </mat-form-field>

                                    </div>
                                    <div class="col-sm-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Country </mat-label>
                                            <mat-select formControlName="country" (valueChange)="getselectval($event)"
                                                placeholder="Country" required>
                                                <mat-option *ngFor="let list of countryList" [value]="list._id"
                                                    (click)="stateEmpty()">
                                                    {{ list.countryName }}
                                                </mat-option>
                                            </mat-select>
                                            <mat-error
                                                *ngIf="updateCompanyProfileForm.get('country').hasError('required')">
                                                Please select country </mat-error>
                                        </mat-form-field>
                                    </div>

                                    <div class="col-sm-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Postal Code</mat-label>
                                            <input formControlName="postalCode" type="text" matInput
                                                placeholder="Postal code" [(ngModel)]="zipcode" required
                                                (focusout)="getCityByZipcode()" />
                                            <mat-error
                                                *ngIf="updateCompanyProfileForm.get('postalCode').hasError('required')">
                                                Please enter postal code </mat-error>
                                            <mat-error
                                                *ngIf="updateCompanyProfileForm.get('postalCode').hasError('minlength')">
                                                Minimum length should be 3 </mat-error>
                                        </mat-form-field>

                                    </div>
                                    <div class="col-sm-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>City </mat-label>
                                            <input type="text" formControlName="city" type="text" matInput
                                                placeholder="City" required maxlength="80" />
                                            <mat-error
                                                *ngIf="updateCompanyProfileForm.get('city').hasError('required')">
                                                Please select city </mat-error>

                                        </mat-form-field>
                                    </div>
                                    <div class="col-sm-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>State </mat-label>
                                            <mat-select formControlName="state" placeholder="State" required>
                                                <mat-option *ngFor="let list of stateList" [value]="list._id">
                                                    {{ list.stateName }}
                                                </mat-option>
                                            </mat-select>
                                            <mat-error
                                                *ngIf="updateCompanyProfileForm.get('state').hasError('required')">
                                                Please select state </mat-error>
                                        </mat-form-field>
                                    </div>


                                    <div class="col-sm-12 abt-compny">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>About Company </mat-label>
                                            <textarea type="text" formControlName="aboutCompany" matInput
                                                placeholder="About Company" required id="autoresizing" minlength="10"
                                                maxlength="200"></textarea>
                                            <mat-error
                                                *ngIf="updateCompanyProfileForm.get('aboutCompany').hasError('required')">
                                                Please brief about your company </mat-error>
                                            <mat-error
                                                *ngIf="updateCompanyProfileForm.get('aboutCompany').hasError('pattern')">
                                                Please enter valid about company </mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>
                                <div class="col-sm-12">
                                    <div class="form-group text-center">
                                        <button class="btn btn-primary cus-dash-form-btn"
                                            (click)="onSubmitCompanyProfileForm()">Submit</button>
                                    </div>
                                </div>
                            </div>
                        </form>

                    </div>
                </div>
            </div>
        </section>
    </div>
    <div class="modal" id="banner-image-dialog">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <strong>
                        <h5>Edit Banner Image</h5>
                    </strong>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body ">
                    <div class="d-flex justify-content-center align-items-center my-2" *ngIf="isLoading">
                        <mat-progress-bar class="example-margin" [color]="'primary'" [mode]="'indeterminate'"  #spinner>
                        </mat-progress-bar>
                       </div>
                    <div #cropContainer class='image_cropper' style="display: block; width: 600px;height: 400px;margin-left: 71px;">
                        <image-cropper [imageChangedEvent]="imageChangedEvent" [maintainAspectRatio]="true"
                            [cropperMinHeight]="10600" [cropperMinWidth]="10800" [cropperMaxHeight]="700"
                            [cropperMaxWidth]="799" [aspectRatio]="8 / 3" [resizeToHeight]="300" format="png"
                            (imageCropped)="imageCropped($event)" (imageLoaded)="imageLoaded()"
                            (cropperReady)="cropperReady()" (loadImageFailed)="loadImageFailed()"></image-cropper>
                    </div>
                </div>
                <div class='col-md-12 text-center mt-2 mb-2'>
                    <button class='btn common-btn' data-dismiss="modal" (click)='uploadBannerImage()'>Upload</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal" id="logo-image-dialog">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <strong>
                        <h5>Edit Image</h5>
                    </strong>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body ">
                    <div class="d-flex justify-content-center align-items-center my-2" *ngIf="isLoading">
                        <mat-progress-bar class="example-margin" [color]="'primary'" [mode]="'indeterminate'"  #spinner>
                        </mat-progress-bar>
                       </div>
                    <div #cropContainer class='image_cropper' style="display: block; width: 600px;height: 400px; margin-left: 71px;"
                        class='text-center'>
                        <image-cropper [imageChangedEvent]="logoChangedEvent" [maintainAspectRatio]="true"
                            [roundCropper]='true' [cropperMinHeight]="10600" [cropperMinWidth]="10800"
                            [cropperMaxHeight]="700" [cropperMaxWidth]="799" [aspectRatio]="4 / 4"
                            [resizeToHeight]="300" format="png" (imageCropped)="logoCropped($event)"
                            (imageLoaded)="imageLoaded()" (cropperReady)="cropperReady()"
                            (loadImageFailed)="loadImageFailed()"></image-cropper>
                    </div>
                </div>
                <div class='col-md-12 text-center mt-2 mb-2'>
                    <button class='btn btn-common ' *ngIf='roleName != "ENDUSER"' data-dismiss="modal"
                        (click)='uploadCompanyLogo()'>upload</button>
                    <!-- <button class='btn btn-common ' *ngIf='roleName == "ENDUSER"' data-dismiss="modal"
                        (click)='uploadUserProfilrImage()'>upload</button> -->

                </div>
            </div>
        </div>
    </div>
</div>